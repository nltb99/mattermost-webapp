"use strict";(self.webpackChunkmattermost_webapp=self.webpackChunkmattermost_webapp||[]).push([[6626],{56626:(e,t,r)=>{r.r(t),r.d(t,{default:()=>R});var s=r(64323),i=r(97779),a=r(73396),n=r(22742),o=r(89754),l=r(37792),c=r(48431),m=r.n(c),u=(r(88674),r(33948),r(41637),r(74916),r(64765),r(4723),r(41817),r(54156)),d=r.n(u),g=r(94687),f=r(21005),p=r(16794),h=r(34288),v=r(39345),E=r(19476),T=r(56640),b=r(73406),S=r(37668),_=r(89658),y=r(63200),O=r(54140),C=r(71124);function M(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class w extends d().PureComponent{constructor(e){super(e),M(this,"formattedText",void 0),M(this,"getTermsOfService",(async()=>{this.setState({customTermsOfServiceId:"",customTermsOfServiceText:"",loading:!0});const{data:e}=await this.props.actions.getTermsOfService();e?this.setState({customTermsOfServiceId:e.id,customTermsOfServiceText:e.text,loading:!1}):h.gc("/login?extra=".concat(C.gT.GET_TERMS_ERROR))})),M(this,"handleLogoutClick",(e=>{e.preventDefault(),h.gc("/login")})),M(this,"handleAcceptTerms",(()=>{this.setState({loadingAgree:!0,serverError:null}),this.registerUserAction(!0,(()=>{const e=new URLSearchParams(this.props.location.search).get("redirect_to");e&&e.match(/^\/([^/]|$)/)?(0,_.s)().push(e):this.props.useCaseOnboarding?(0,_.s)().push("/"):h.mc()}))})),M(this,"handleRejectTerms",(()=>{this.setState({loadingDisagree:!0,serverError:null}),this.registerUserAction(!1,(()=>{h.gc("/login?extra=".concat(C.gT.TERMS_REJECTED))}))})),M(this,"registerUserAction",(async(e,t)=>{const{data:r}=await this.props.actions.updateMyTermsOfServiceStatus(this.state.customTermsOfServiceId,e);r?t(r):this.setState({loadingAgree:!1,loadingDisagree:!1,serverError:d().createElement(f.FormattedMessage,{id:"terms_of_service.api_error",defaultMessage:"Unable to complete the request. If this issue persists, contact your System Administrator."})})})),this.state={customTermsOfServiceId:"",customTermsOfServiceText:"",loading:!0,loadingAgree:!1,loadingDisagree:!1,serverError:null},this.formattedText=(0,p.GA)((t=>(0,O.RZ)(t,{},e.emojiMap)))}componentDidMount(){this.props.termsEnabled?this.getTermsOfService():h.mc()}render(){if(this.state.loading)return d().createElement(E.Z,null);let e="terms-of-service__markdown";return this.state.serverError?e+=" terms-of-service-error__height--fill":e+=" terms-of-service__height--fill",d().createElement("div",null,d().createElement(v.Z,null),d().createElement("div",{className:"signup-header"},d().createElement("a",{href:"#",onClick:this.handleLogoutClick},d().createElement(b.Z,null),d().createElement(f.FormattedMessage,{id:"web.header.logout",defaultMessage:"Logout"}))),d().createElement("div",null,d().createElement("div",{className:"signup-team__container terms-of-service__container"},d().createElement("div",{className:e},d().createElement("div",{className:"medium-center","data-testid":"termsOfService"},(0,y.Z)(this.formattedText(this.state.customTermsOfServiceText),!1,{mentions:!1}))),d().createElement("div",{className:"terms-of-service__footer medium-center"},d().createElement(g.ButtonGroup,{className:"terms-of-service__button-group"},d().createElement(g.Button,{bsStyle:"primary",disabled:this.state.loadingAgree||this.state.loadingDisagree,id:"acceptTerms",onClick:this.handleAcceptTerms,type:"submit"},this.state.loadingAgree&&d().createElement(T.Z,null),d().createElement(f.FormattedMessage,{id:"terms_of_service.agreeButton",defaultMessage:"I Agree"})),d().createElement(g.Button,{bsStyle:"link",disabled:this.state.loadingAgree||this.state.loadingDisagree,id:"rejectTerms",onClick:this.handleRejectTerms,type:"reset"},this.state.loadingDisagree&&d().createElement(T.Z,null),d().createElement(f.FormattedMessage,{id:"terms_of_service.disagreeButton",defaultMessage:"I Disagree"}))),Boolean(this.state.serverError)&&d().createElement("div",{className:"terms-of-service__server-error alert alert-warning"},d().createElement(S.Z,null)," ",this.state.serverError)))))}}M(w,"propTypes",{location:m().shape({search:m().string.isRequired}).isRequired,termsEnabled:m().bool.isRequired,actions:m().shape({getTermsOfService:m().func.isRequired,updateMyTermsOfServiceStatus:m().func.isRequired}).isRequired,useCaseOnboarding:m().bool.isRequired});const R=(0,s.connect)((function(e){const t=(0,n.iE)(e);return{useCaseOnboarding:(0,o.NC)(e),termsEnabled:"true"===t.EnableCustomTermsOfService,emojiMap:(0,l.kM)(e)}}),(function(e){return{actions:(0,i.bindActionCreators)({getTermsOfService:a.Oi,updateMyTermsOfServiceStatus:a.oR},e)}}))(w)},73406:(e,t,r)=>{r.d(t,{Z:()=>n});var s=r(54156),i=r.n(s),a=r(21005);function n(){const{formatMessage:e}=(0,a.useIntl)();return i().createElement("i",{className:"fa fa-1x fa-angle-left",title:e({id:"generic_icons.logout",defaultMessage:"Logout Icon"})})}},37668:(e,t,r)=>{r.d(t,{Z:()=>m});var s=r(48431),i=r.n(s),a=(r(41817),r(54156)),n=r.n(a),o=r(68492),l=r(87993);function c(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class m extends n().PureComponent{render(){const e="fa fa-warning"+(this.props.additionalClassName?" "+this.props.additionalClassName:"");return n().createElement(o.Z,{className:e,title:{id:(0,l.t)("generic_icons.warning"),defaultMessage:"Warning Icon"}})}}c(m,"propTypes",{additionalClassName:i().oneOfType([i().string,i().oneOf([null])])}),c(m,"defaultProps",{additionalClassName:null})}}]);
//# sourceMappingURL=6626.ece4423ee462e3d9fca8.js.map